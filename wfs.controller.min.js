!function(){"use strict";function e(e,t,a,r){OpenLayers.ProxyHost="/proxy/index?url=",e.source=[],e.endPoint="",e.version="1.1.0",e.outputFormat="JSON",e.maxFeatures="50",e.showFeatureTypeSelect=!1,e.showFeatureTypeTable=!1,e.showGetFeatureTable=!1,e.featureTypeItem={},e.featureTypes=[];var o;e.getCapabilities=function(){t.warn("outputFormat",e.outputFormat),o=new OGC.WFS.Client(e.endPoint),e.showFeatureTypeSelect=!1,e.showFeatureTypeTable=!1,e.capabilities=o.getFeatureTypes(),t.debug("$scope.capabilities",e.capabilities),t.debug("$scope.capabilities.length",e.capabilities.length),e.capabilities.length>=1?e.showFeatureTypeSelect=!0:(e.showFeatureTypeSelect=!1,e.showFeatureTypeTable=!1,alert("Error. Could not retrieve data from end point.  Please check the URL and try again."))},e.describeFeature=function(){e.columns=o.getFeatureTypeSchema(e.selectedCapability.name,e.selectedCapability.featureNS).featureTypes[0].properties,t.debug("$scope.columns (describeFeature)",e.columns),t.debug("$scope.columns.length",e.columns.length),e.columns.length>=1&&(e.getFeature(),e.showFeatureTypeTable=!0)},e.getFeature=function(){r.spin("spinner");var s=a.defer(),u={typeName:e.selectedCapability.name,namespace:e.selectedCapability.featureNS,version:e.version,maxFeatures:e.maxFeatures,outputFormat:e.outputFormat};e.filter&&""!==e.filter.trim()&&(u.cql=e.filter),o.getFeature(u,function(e){s.resolve(e)});var i=s.promise;i.then(function(a){e.features=a,t.warn("$scope.features",e.features),e.showGetFeatureTable=!0,r.stop("spinner")})}}angular.module("omarApp").controller("WfsController",["$scope","$log","$q","usSpinnerService",e])}();